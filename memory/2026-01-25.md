# 2026-01-25 - CVR Agent Setup Progress

## Announcements App CVR Testing Environment

### Key URLs & Config Discovered
- **CVR Loop Branch**: `CVR-Loop` on GitHub (announcements-whop-app repo)
- **Railway URL**: `https://announcements-whop-app-cvr-loop.up.railway.app`
- **Dev Bypass Endpoint**: `/api/dev-bypass` - sets `whop_dev_bypass=enabled` cookie
- **Experience ID for testing**: `exp_TlznjVTiLJR9iO`
- **Demo Experience ID**: `exp_mxsm0HJFMBaPWd`

### Conversion Funnel Structure
- Main upsell: `HubGiftModal` component (`components/hub-gift-modal.tsx`)
- Hub types: clipping, trading, sports, fitness, ecommerce
- Conversion buttons text varies: "Claim for $5/week", "Claim for $4.99/week", etc.
- **Conversion button keyword to track**: "Claim"

### Hub Plan IDs (from hub-gift-modal.tsx)
- Clipping: `plan_lhhE1k2tvrmzv` - $5/week (80% off from $25)
- Trading/Sports/Fitness/Ecommerce: Different plans, ~$4.99-5/week

### Command Central CVR Agent
- Location: `C:\Users\theul\Desktop\Osis\Command-Central`
- Port: 3001
- **Local run endpoint**: `/api/cvr-agents/run-local` (no auth required)
- Uses Stagehand + OpenAI for AI-driven user simulation
- Set `CHROME_PATH="C:\Program Files\Google\Chrome\Application\chrome.exe"` in .env.local for Windows

### Blocker
- OpenAI API key (from announcements app) hit quota limit (429 insufficient_quota)
- Need new API key or quota top-up to run CVR simulations

## CVR Loop Auth Bypass Implementation
- Created `lib/dev-bypass.ts` with `shouldBypassAuth()` function
- Modified `lib/auth.ts` to return mock auth for CVR testing
- Pushed commit to Railway with message "Add CVR_BYPASS_AUTH env var for reliable auth bypass in testing"
- The bypass activates when `CVR_BYPASS_AUTH=true` env var is set OR when running on localhost
- This allows Command-Central CVR agents to test the app without needing real Whop authentication

### **ACTION NEEDED**: Add env var in Railway
Railway UI browser automation failed. Manual steps required:
1. Go to Railway project → announcements-whop-app service → Variables tab
2. Click **"+ New Variable"**
3. Name: `CVR_BYPASS_AUTH`
4. Value: `true`
5. Click Add → Service will redeploy

## Next Steps
1. ✅ Auth bypass code deployed
2. **Add CVR_BYPASS_AUTH=true env var in Railway** (manual step)
3. Get fresh OpenAI API key
4. Run CVR simulation with 100 agents
5. Analyze results and iterate on funnel copy/UX
