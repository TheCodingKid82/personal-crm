# 2026-01-29 - Agent Fleet Browser Configuration Day

## Major Accomplishments

### Agent Fleet Browser Access (Finally Working!)
- Deployed browserless Chrome instances for all 7 agents on Railway
- Each agent has dedicated browser: `[agent]-browser-production.up.railway.app`
- Fixed config structure: `browser.profiles.remote.cdpUrl` with HTTPS URLs
- **Navigation works**, screenshots/snapshots have port conflict issues (Moltbot beta limitation)

### Config Format That Works
```json
{
  "browser": {
    "enabled": true,
    "defaultProfile": "remote",
    "profiles": {
      "remote": {
        "cdpUrl": "https://[agent]-browser-production.up.railway.app",
        "color": "#00AA00"
      }
    }
  }
}
```

### Key Learnings
1. Agents run **Moltbot v2026.1.27-beta.1** (not Clawdbot) - different behavior
2. Config stored in `CLAWDBOT_CONFIG_B64` env var on Railway
3. `target="custom"` not supported in Moltbot - must use profiles
4. cdpUrl needs HTTPS not WSS
5. Agents are security-conscious - rejected config patches from me as "prompt injection"
6. Remote CDP: navigation works, but screenshots need Playwright (not available)

### Dashboard Fixes
- Fixed agent messaging to fetch from Railway (not local store)
- Added session persistence with `x-clawdbot-session-key` header
- Removed invalid `session` param from request body

### Booked.Travel Email Fix
- Root cause: `EMAIL_PROVIDER` env var likely not set on admin deployment
- Added "Resend Confirmation" button to booking detail pages
- Created `/api/bookings/[id]/resend-confirmation` endpoint
- Files in `temp-booked` ready to deploy

## Agent Browser Commands
Tell agents to use:
```
browser(action="navigate", profile="remote", targetUrl="https://example.com")
browser(action="tabs", profile="remote")
```
NOT profile="chrome" or "clawd"

## Pending Issues
- Screenshots/snapshots fail with port conflict on remote CDP
- May need Moltbot update to fix remote CDP screenshot support

## Andrew's Mood
Frustrated by end of session - browser kept asking for Chrome extension. Finally got navigation working but he went to sleep before fully testing.
