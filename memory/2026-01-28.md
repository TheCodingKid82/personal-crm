# 2026-01-28 - Agent Factory & Booked.Travel Day

## Agent Factory Command Center

### Infrastructure Deployed
- **Dashboard:** https://command-center-production-3605.up.railway.app
- **Atlas (Head of Announcements):** https://atlas-production-7bf2.up.railway.app
- **Apollo (Head of Agency):** https://apollo-production-3d0d.up.railway.app

### Key Fixes
- Fixed auth/pairing issues with `trustedProxies: ["*"]` and `allowInsecureAuth: true`
- Auth profiles format: `version: 1`, `profiles.anthropic:claude-cli` with `type: "oauth"`, `access: <token>`
- All config via base64 env vars to bypass Cloudflare WAF on Railway

### Provisioning Flow
- New agents deploy fully configured out-of-the-box
- Includes: gateway config, auth profiles, IDENTITY.md, SOUL.md
- Agents registered in chat team roster automatically

### Chat System
- API endpoints: `/api/chat/send`, `/api/chat/messages`, `/api/chat/conversations`, `/api/chat/team`
- Observer mode for Andrew to watch agent-to-agent conversations
- Fixed conversation ID format issue (`:` vs `-` separator)

## Booked.Travel Updates

### ResourceViewer Feature
- View button on resources page (andrewweir@weirtech.net only for now)
- Shows resource units as boxes with participants assigned
- Groups participants by booking (people who booked together stay together)
- Private room detection: checks `privateRoomReservation` and `privateRoomReservations` fields
- Adjustable preview mode:
  - Edit units and capacity per unit
  - Live preview of layout changes
  - OVERSOLD warning with red badge
  - Overflow list shows unaccommodated participants
  - Save button only commits when clicked

### Resource Usage Display Fix
- Bookings page now shows decimal units (e.g., "3 participants using 1.5 units")
- Calculation: participantCount / capacity
- Private rooms = 1 unit regardless of capacity

### Payment Metadata
- Added individual participant fields for Whop dashboard visibility:
  - `participant2Name`, `participant2Email`, `participant2Phone`
  - Up to 10 additional participants
  - `additionalParticipantCount` for total

## Lessons Learned
- Railway Cloudflare WAF blocks JSON with certain patterns - use base64 encoding
- frosted-ui doesn't have Grid/Dialog - use CSS classes and custom modals
- Whop checkout metadata needs both JSON and individual fields for visibility
